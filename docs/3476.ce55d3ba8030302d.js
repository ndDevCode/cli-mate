"use strict";(self.webpackChunkcli_mate=self.webpackChunkcli_mate||[]).push([[3476],{3476:(v,c,s)=>{s.r(c),s.d(c,{ImageDrawer:()=>I});var g=s(1528),u=s(3776);class I{constructor(n){var e=this;this.loadImageShape=function(){var i=(0,g.c)(function*(o){if(!e._engine.loadImage)throw new Error(`${u.iQ} image shape not initialized`);yield e._engine.loadImage({gif:o.gif,name:o.name,replaceColor:o.replaceColor??!1,src:o.src})});return function(o){return i.apply(this,arguments)}}(),this._engine=n}addImage(n){this._engine.images||(this._engine.images=[]),this._engine.images.push(n)}draw(n){return(0,g.c)(function*(){const{context:e,radius:i,particle:o,opacity:a}=n,l=o.image,t=l?.element;if(l){if(e.globalAlpha=a,l.gif&&l.gifData){const{drawGif:m}=yield s.e(4576).then(s.bind(s,4576));m(n)}else if(t){const r={x:-i,y:-i},f=2*i;e.drawImage(t,r.x,r.y,f,f/l.ratio)}e.globalAlpha=1}})()}getSidesCount(){return 12}init(n){var e=this;return(0,g.c)(function*(){const i=n.actualOptions;if(i.preload&&e._engine.loadImage)for(const o of i.preload)yield e._engine.loadImage(o)})()}loadShape(n){var e=this;return(0,g.c)(function*(){if("image"!==n.shape&&"images"!==n.shape)return;e._engine.images||(e._engine.images=[]);const i=n.shapeData;i&&(e._engine.images.find(a=>a.name===i.name||a.source===i.src)||(yield e.loadImageShape(i),yield e.loadShape(n)))})()}particleInit(n,e){var i=this;return(0,g.c)(function*(){if("image"!==e.shape&&"images"!==e.shape)return;i._engine.images||(i._engine.images=[]);const o=i._engine.images,a=e.shapeData;if(!a)return;const l=e.getFillColor(),t=o.find(d=>d.name===a.name||d.source===a.src);if(!t)return;const m=a.replaceColor??t.replaceColor;if(t.loading)return void setTimeout(()=>{i.particleInit(n,e)});let r;if(t.svgData&&l){const{replaceImageColor:d}=yield Promise.resolve().then(s.bind(s,2888));r=yield d(t,a,l,e)}else r={color:l,data:t,element:t.element,gif:t.gif,gifData:t.gifData,gifLoopCount:t.gifLoopCount,loaded:!0,ratio:a.width&&a.height?a.width/a.height:t.ratio??1,replaceColor:m,source:a.src};r.ratio||(r.ratio=1);const h={image:r,fill:a.fill??e.shapeFill,close:a.close??e.shapeClose};e.image=h.image,e.shapeFill=h.fill,e.shapeClose=h.close})()}}}}]);